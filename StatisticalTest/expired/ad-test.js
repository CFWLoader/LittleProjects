import * as transformations from '../lib/transformations';

import spMath from '../lib/special-functions';

import {shape} from '../lib/shape';

// import statisticTest from '../lib/statistic-test';

function andersonDarlingTest(data) {
    
    let n = data.length;

    let s = 0, mul;

    for (let i = 0; i < data.length; ++i) {

        mul = data[i] * (1 - data[n - 1 - i]);

        if(mul == 0)
        {
            console.log('Skipping: ' + i.toString());
            continue;
        }

        // console.log(data[i]);

        s += (2 * i + 1) * Math.log(mul)      // Notice original is (2 * i - 1) and data[n + 1 - i]. Fix head offset.
    }

    // console.log(s);

    return -n - s / n;
}

function adpValueNormal(z, n) {
    
    let zStar = z * (1 + 0.75 / n + 2.25 / (n ** 2));

    // var math = require('mathjs');

    console.log(zStar);

    if (zStar <= 0.2) {
        return 1 - Math.exp(-13.436 + 101.14 * zStar - 223.73 * (zStar ** 2));
    }
    else if (zStar <= 0.34) {
        return 1 - Math.exp(-8.318 + 42.796 * zStar - 59.938 * (zStar ** 2));
    }
    else if (zStar <= 0.6) {
        return Math.exp(0.9177 - 4.279 * zStar - 1.38 * (zStar ** 2));
    }
    else if (zStar <= 153.467) {
        return Math.exp(1.2937 - 5.709 * zStar + 0.0186 * (zStar ** 2));
    }
    else {
        return 0;
    }
}

function adpValueUniform(z) {
    let p = 0;

    let g = (zz) => {
        return (2.00012 + (0.247105 - (0.0649821 - (0.0347962 - (0.0116720 - 0.00168691 * zz) * zz) * zz) * zz) * zz);
    }

    let gg = (zz) => {
        return (1.0776 - (2.30695 - (0.43424 - (0.082433 - (0.008056 - 0.0003146 * zz) * zz) * zz) * zz) * zz);
    }

    if (z < 2) {
        p = 1 - Math.pow(z, - 0.5) * Math.exp(-1.2337141 / z) * g(z);
    }
    else {
        p = 1 - Math.exp(-Math.exp(gg(z)));
    }

    return p;
}

function adpValueExponent(adValue, n) {
    let zStar = adValue * (1 + 0.6 / n);

    // console.log(zStar);

    if (zStar <= 0.26) {
        return 1 - Math.exp(-12.2204 + 67.459 * zStar - 110.3 * (zStar ** 2));
    }
    else if (zStar <= 0.51) {
        return 1 - Math.exp(-6.1327 + 20.218 * zStar - 18.663 * zStar ** 2);
    }
    else if (zStar <= 0.95) {
        return Math.exp(0.9209 - 3.353 * zStar + 0.3 * zStar ** 2);
    }
    else if (zStar <= 10.03) {
        return Math.exp(0.731 - 3.008 * zStar + 0.15 * zStar ** 2);
    }

    return 0;
}

function adpValueGamma(adValue, alpha)
{

}

function kolmogorovSmirnovTest(data) {
    let len = data.length, wn = data.length;

    let wi = 1;

    let dplus = 0, dminus = 0, dp, dm;

    for (let i = 0; i < len; ++i, ++wi) {
        dp = Math.abs(data[i] - wi / wn);

        dm = Math.abs(data[i] - (wi - 1) / wn);

        dplus = dplus > dp ? dplus : dp;

        dminus = dminus > dm ? dminus : dm;
    }

    return Math.max(dplus, dminus);

    // D = Math.sqrt(dn) * dn;

    // k = 100;

    // var ak;

    // while(true)
    // {
    //     ak = 0;

    //     for(i = -k; i <= k; ++i)
    //     {
    //         ak += Math.pow(-1, i) * Math.exp(-2 * (i * D)**2);
    //     }

    //     if((Math.pow(-1, k + 1) * Math.exp(-2 * ((k + 1) * D)**2)) < 0.00001)
    //     {
    //         break;
    //     }
    // }

    // return 1 - ak;
}

function kspValueUniform(wn, dn) {
    let D = Math.sqrt(wn) * dn;

    let k = 100;

    let ak;

    while (true) {
        ak = 0;

        for (let i = -k; i <= k; ++i) {
            ak += Math.pow(-1, i) * Math.exp(-2 * (i * D) ** 2);
        }

        if ((Math.pow(-1, k + 1) * Math.exp(-2 * ((k + 1) * D) ** 2)) < 0.00001) {
            break;
        }
    }

    return 1 - ak;
}

function kspValueNormal(wn, dn) {
    let d = dn * (Math.sqrt(wn) - 0.01 + 0.85 / Math.sqrt(wn));

    if (d < 0.775) {
        return "0.15+";
    }
    else if (d < 0.819) {
        return "0.1~0.15";
    }
    else if (d < 0.895) {
        return "0.05~0.1";
    }
    else if (d < 0.995) {
        return "0.025~0.05";
    }
    else if (d < 1.035) {
        return "0.01~0.025";
    }
    else {
        return "0.01-"
    }
}

function kspValueExponent(wn, dn) {
    let d = (dn - 0.2 / wn) * (Math.sqrt(wn) + 0.25 + 0.5 / Math.sqrt(wn));

    if (d < 0.926) {
        return "0.15+";
    }
    else if (d < 0.995) {
        return "0.1~0.15";
    }
    else if (d < 1.094) {
        return "0.05~0.1";
    }
    else if (d < 1.184) {
        return "0.025~0.05";
    }
    else if (d < 1.298) {
        return "0.01~0.025";
    }
    else {
        return "0.01-"
    }
}

function batchTest(dist_data) {
    // Calculating p value for normal dist.
    let transformed = transformations.normality(dist_data), z, dn, pvalue, ksp;

    // z = andersonDarlingTest(transformed);
    // z = statisticTest.AndersonDarling.test(transformed);

    // dn = kolmogorovSmirnovTest(transformed);

    console.log("|Normal|" + statisticTest.AndersonDarling.pValueNormal(dist_data).toFixed(5).toString() + "|" + statisticTest.KolmogorovSmirnov.pValueNormal(dist_data) + "|");    
    // console.log("|Normal|" + z.toFixed(5).toString() + "|" + adpValueNormal(z, transformed.length).toFixed(5).toString() + "|" + dn.toFixed(5).toString() + "|" + kspValueNormal(transformed.length, dn).toString() + "|");

    // console.log('Nor:');

    // console.log("AD-Value: " + z.toString() + "    p-Value(AD): " + adpValueNormal(z, transformed.length) + "    KS-Value: " + dn.toString() + "    p-Value(KS): " + kspValueNormal(transformed.length, dn).toString());

    // Calculating p value for lognormal dist.
    // transformed = transformations.logNormality(dist_data);

    // var z, pvalue, dn, ksp;

    // if (transformed == 0) {
    //     z = 'N/A';

    //     pvalue = 'N/A';

    //     dn = 'N/A'

    //     ksp = 'N/A'
    // }
    // else {
    //     z = andersonDarlingTest(transformed).toFixed(5);

    //     pvalue = adpValueNormal(z, transformed.length).toFixed(5);

    //     dn = kolmogorovSmirnovTest(transformed).toFixed(5);

    //     ksp = kspValueNormal(transformed.length, dn);
    // }

    // console.log("|Log-Normal|" + z.toString() + "|" + pvalue.toString() + "|" + dn.toString() + "|" + ksp + "|");
    console.log("|Log-Normal|" + statisticTest.AndersonDarling.pValueLogNormal(dist_data) + "|" + statisticTest.KolmogorovSmirnov.pValueLogNormal(dist_data) + "|");
    

    // console.log('Lognor:');

    // console.log("AD-Value: " + z.toString() + "    p-Value(AD): " + pvalue.toString() + "    KS-Value: " + dn.toString() + "    p-Value(KS): " + ksp);

    // Calculating p value for uniform dist.
    transformed = transformations.uniform(dist_data);

    // transformed.shift();

    // transformed.pop();

    z = andersonDarlingTest(transformed);

    dn = kolmogorovSmirnovTest(transformed);

    console.log("|Uniform|" + z.toFixed(5).toString() + "|" + adpValueUniform(z).toFixed(5).toString() + "|" + dn.toFixed(5).toString() + "|" + kspValueUniform(transformed.length, dn).toFixed(5).toString() + "|");

    // console.log('Unif:');

    // console.log("AD-Value: " + z.toString() + "    p-Value(AD): " + adpValueUniform(z).toString() + "    KS-Value: " + dn.toString() + "    p-Value(KS): " + kspValueUniform(transformed.length, dn).toString());

    // Calculating ad value for trangular dist.
    transformed = transformations.triangle(dist_data);

    transformed.shift();

    transformed.pop();

    z = andersonDarlingTest(transformed);

    dn = kolmogorovSmirnovTest(transformed);

    console.log("|Triangular|" + z.toFixed(5).toString() + "|N/A" + "|" + dn.toFixed(5).toString() + "|N/A|");

    // console.log('Tria:');

    // console.log("AD-Value: " + z.toString() + "    p-Value(AD): N/A" + "    KS-Value: " + dn.toString() + "    p-Value(KS): N/A");

    // Calculating p value for exponent dist.
    transformed = transformations.exponent(dist_data);

    if (transformed == 0) {
        z = 'N/A';

        pvalue = 'N/A';

        dn = 'N/A';

        ksp = 'N/A';
    }
    else {
        z = andersonDarlingTest(transformed).toFixed(5);

        pvalue = adpValueExponent(z, transformed.length).toFixed(5);

        dn = kolmogorovSmirnovTest(transformed).toFixed(5);

        ksp = kspValueExponent(transformed.length, dn);
    }

    console.log("|Exponential|" + z.toString() + "|" + pvalue.toString() + "|" + dn.toString() + "|" + ksp + "|");

    // console.log('Exp:')

    // console.log("AD-Value: " + z.toString() + "    p-Value(AD): " + pvalue.toString() + "    KS-Value: " + dn.toString() + "    p-Value(KS): " + ksp);
}

var fs = require('fs');

// console.log("AQI:")
// var file = ".\\aqi_dist.json";
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("PM2.5:")
// var file = ".\\pm25_dist.json"
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("Norm:");
// let file = ".\\dataset\\norm_dist1.json"
// let dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

console.log('Start');

let aqiData = [68,73,133,91,81,110,60,61,77,78,74,46,22,36,60,83,67,100,88,176,163,79,87,98,92,92,87,68,71,51,51,58,73,106,68,58,116,129,88,96,124,144,147,95,85,102,64,54,67,84,51,49,42,28,35,32,36,31,36,23,46,44,18,25,17,38,90,89,40,31,26,48,76,66,53,42,48,52,51,67,82,57,29,47,34,45,60,73,52,43,42,39,39,33,49,83,64,21,34,22,34,57,89,102,136,170,88,54,56,42,55,69,71,71,121,89,110,93,99,89,37,28,66,62,37,37,31,36,39,46,37,75,61,40,34,33,42,40,41,32,33,49,44,67,99,45,46,61,64,57,43,44,34,50,55,39,63,36,44,47,36,37,49,47,31,51,54,58,84,73,55,43,28,32,28,53,69,62,68,89,86,77,86,85,78,48,50,55,50,40,39,65,101,159,155,117,91,74,52,58,46,45,44,43,43,44,38,41,46,42,41,48,86,75,85,134,172,200,104,76,60,61,62,104,49,57,62,75,51,81,115,68,77,82,95,112,110,115,139,73,65,53,54,50,45,57,75,82,66,58,125,157,136,150,75,79,63,59,64,95,110,80,48,63,55,96,72,86,60,55,69,68,88,78,52,51,30,44,68,52,49,46,38,49,88,102,131,119,101,93,82,83,75,67,70,73,80,70,65,77,84,61,67,41,33,51,70,83,84,72,73,63,56,47,67,71,39,64,64,62,60,94,85,79,72,51,45,68,55,37,57,84,95,64,85,78,44,44,50,33,40,52,53,53,52,69,90,47,43,69,48,68,101,105,115,166,162,78,44,52,54,49,72,57,70,88,105,153,99,70,48,63,62,78,82,53,48,54,64,53,57,47,60,63,68,48,38,29,48,53,72,73,77,68,48,49,32,33,57,58,42,68,53,130,82,75,56,44,36,30,30,43,48,75,82,62,79,60,39,34,49,60,60,89,85,109,116,98,94,92,98,70,70,59,30,39,55,54,47,68,59,68,88,67,60,73,80,68,42,58,87,70,92,109,120,175,129,67,64,54,62,52,50,53,54,68,59,64,93,70,58,54,50,45,77,74,73,74,85,70,59,48,62,53,72,85,54,49,47,59,42,43,53,42,38,55,110,147,110,57,68,63,68,100,59,59,42,51,85,97,109,87,33,40,52,53,52,65,75,64,62,60,120,117,49,44,42,39,44,56,45,40,53,74,36,47,58,50,52,83,103,80,51,58,48,38,39,34,32,28,30,40,49,108,89,111,63,67,50,54,48,50,43,57,45,35,35,52,95,118,160,202,86,40,87,96,113,192,89,30,39,39,103,113,107,100,84,72,77,82,75,37,33,37,25,32,48,90,90,118,155,78,197,122,57,47,119,128,131,50,53,53,59,58,58,63,67,64,48,53,60,61,66,61,45,44,49,79,65,91,102,129,164,201,179,94,70,38,48,52,40,38,50,61,54,48,35,44,62,52,46,39,42,52,50,59,33,42,48,42,65,70,50,48,69,72,85,53,37,51,38,33,43,90,166,100,101,72,43,47,53,107,107,105,114,95,105,113,103,80,68,50,38,39,45,45,58,64,82,80,87,80,85,102,97,69,92,98,110,112,102,94,100,46,44,55,94,108,113,128,119,57,65,87,83,72,37,59,64,88,107,111,123,125,115,205,124,109,90,83,103,88,50,52,53,53,59,58,68,52,40,75,62,82,85,77,75,69,117,53,43,48,32,43,59,75,55,58,68,60,42,78,65,80,106,108,109,105,116,118,80,90,77,84,43,42,47,59,87,105,84,83,105,106,89,54,55,59,77,84,73,100,102,57,69,78,82,88,85,101,78,95,92,85,49,58,93,102,88,84,63,72,95,117,89,65,93,83,65,54,55,55,45,60,100,102,78,88,85,80,67,60,51,79,97,98,84,47,106,173,139,80,54,44,79,99,113,59,55,80,201,147,68,84,148,47,52,100,130,77,75,64,75,70,54,57,62,90,156,159,90,87,52,54,85,49,39,48,52,50,59,45,110,40,52,69,50,57,73,54,68,62,59,57,44,43,44,47,46,50,52,60];

let oriData = [0.863028895738535,5.52001862718258,3.79472340461798,3.05143063764088,2.50427313350141,9.97695506051648,5.01334657498635,9.47924212772399,1.80270974197425,0.458438478265889,4.55786716626491,7.23190802950412,7.70536589718424,10.5202357946942,9.44762940509245,2.87801427878439,2.78544172437396,8.16753967058845,8.25093666995876,1.6546645674156,8.46790258520283,1.88632623973768,4.57673094062135,0.645003614141606,7.22230652293656,8.89896535474341,1.24813863412477,7.32191327151842,6.07439948919229,3.31631766832899,1.78734521930572,1.00207348950673,9.40988535373006,1.42214704818092,3.03714867289644,10.6280477579124,3.10808232481591,1.63271301802248,8.44435011995956,9.37826276028529,6.04636214785744,3.31709595353343,3.29484634380322,7.11609496179968,1.54303656567354,9.50666063087061,0.668597610266879,1.26910401804373,0.649223986193538,10.2230502047623,1.06480806471314,8.80336881204508,8.01474357955623,0.926915107187815,8.62440009220503,2.65860027527902,9.36825715101324,6.7862530210847,1.21659083498642,3.07464716016781,2.46048952690326,2.96605633096304,3.84712262284476,5.82251711221878,6.00110458585899,10.8121096585318,7.13051495163702,0.866919227209873,1.73787726527546,1.99380036649294,8.923710845639,4.29486101568677,2.85462936668657,9.63923358491622,4.52233419443946,0.858337099901401,10.4874741436541,8.17636915149167,0.845740631739609,7.65644460055511,7.18607943214942,2.42063093985431,3.08188671292271,9.6280441233702,3.09005174190737,5.16489690833259,2.72245562833734,3.77656348600984,1.96609405108262,2.28318493384402,3.08187728390098,1.06852234972175,3.31737511611544,8.74262438340113,10.5084797777561,0.890879309633747,8.7129372710269,10.8609176530177,5.04171258188784,9.37202725811396,8.41259366865736,8.98567826729734,2.96143495867494,2.39886536482256,2.22489827564452,3.91310488423333,1.84565325475298,3.38050535531249,2.14632695975248,6.97595575019252,9.80593587221112,1.54569176231045,9.80876638561022,2.06987990640569,7.01444242078345,4.65920727631077,0.372398692131974,5.98364738129079,1.40585442335345,6.09584163810592,8.64321221418679,0.952648895573802,2.12920337477233,6.16521166832652,10.7979337659385,10.1141304791672,9.30351826957893,5.75106855231803,4.10241388529073,5.50303562869318,2.68643202224281,10.8353066082066,2.83774451788515,1.90679212377407,6.64817203412298,3.69211275436915,0.450736032272689,9.65967206547037,2.86150424290448,4.13026109743863,6.89108561199158,5.84072028171737,0.73480232111644,7.16010741390754,1.35825942697003,8.85817480606493,10.3417772596376,0.421234467360191,4.59465570205823,2.52370049232617,2.91245863914955,5.45797886837274,4.93533626479097,5.72446063975804,10.4464597878745,0.880652516707778,8.81572520376183,4.44874198528938,5.90133753646165,10.1856922741979,8.96604665188585,5.18623495081905,6.65016032913234,9.06931829914451,6.05936716890428,2.76295582072809,0.908105271104723,1.818151821387,3.99042875966057,5.16961979090236,0.964116675830446,8.79157961855177,2.26118064745329,7.39494930985849,0.793449185816571,9.74303533976898,2.84364001931157,5.56746290813666,1.92882389803417,4.05008410775103,0.604457204900682,2.12364623598754,2.77903184362687,5.2450173214078,7.13049294148572,7.39701759642921,2.13280973855872,0.899200797337107,10.4282465763064,8.61566842840519,1.37991118112579,10.7539964307938,3.59064086636063,9.48954653199762,9.55853303011973,9.42975605776068,6.82256976079661,8.6164987482084,5.47877397642005,1.65248755298089,2.56996505845804,2.70762410724536,3.41645577542018,8.31350694588851,3.54654667538125,6.27582729742397,4.25156593367923,6.23990894939285,1.05353903105948,7.68303055756725,4.92204517134465,7.30206552078947,10.2919752963493,8.69378598224372,0.291815728330985,10.6975419613253,6.58300444368739,5.82909430535976,4.80900587909855,8.87451906341128,5.31742772094905,0.44682466854807,3.09992468218785,8.86748748524115,5.99282526194118,4.6406427883869,6.76681294213981,6.02911760384217,7.92295219936874,6.4387842055317,1.32648490441032,6.12417868036311,7.35518140671775,3.25573070856743,6.23264518001117,8.42522044172976,5.21557757752016,7.79641987525392,4.23041666273959,6.66088667654432,9.13656166923233,7.1168872552691,6.50835572493728,10.0794250398874,7.6541889894288,0.906373257352971,0.502028907812201,2.77675962064415,3.31196623312309,8.81655686879531,1.63725840962026,4.96853949138895,9.87033984591253,6.67220564752817,8.79292853951454,7.18049200334586,9.78396679014899,5.51374627513345,3.27816123687662,8.05246320828796,6.29503723030444,0.50518479319755,4.37754491395317,0.669109507612884,7.11118477949407,5.77265069204848,7.29488779402338,9.01567307999823,2.23728392736055,4.22816134448629,1.33948474805802,2.81771833551582,6.4996042103041,9.57641017487273,3.3577883550059,0.828496740483679,4.11449164556805,8.77694975541905,1.76694266285282,2.35711848400533,1.97980863145553,10.3859882498626,2.1104933066247,4.47205313806422,8.88040537904948,0.914858183087781,6.8999556160951,0.7882026711246,0.588057644194923,8.09742755476385,2.90481679304969,5.52526305701584,0.425493329875171,5.32275902237743,9.99629585054703,6.31389533831272,9.79153668132145,4.41188597949687,7.54546913725324,0.862914350125939,9.7817584780138,0.671425877478905,3.59085644571576,6.15776038079523,7.25721909789369,6.45303448290564,2.30505824643187,1.85985970541835,0.882012273971923,5.33416814364493,6.84192023301032,9.52158760870807,9.25653696128633,4.47649345030077,3.76015882236417,4.72303573717363,5.95238889849279,5.75755456515588,6.95940928388853,4.99333051659167,3.21924052846618,1.72518076857086,4.89812775654718,4.31266078239773,8.07060011899099,9.61676801360678,1.50186593732331,3.99822189204395,1.29897609709762,8.58118467165623,6.77819713941775,5.55035135576967,10.867727747215,6.54365720546804,9.23373059500009,4.3121774302423,2.14959090783261,5.67844687964767,5.29438688251656,1.66251976157539,8.81732817468699,10.7256851191679,5.48665613971651,4.66136888761073,6.77133738587145,2.1042403958831,7.51579330297187,2.36151513582561,8.69242561441381,1.24206327888649,2.99019127098378,10.1221605036221,1.33119770519901,10.3488816415705,1.54799436466303,3.74736535490956,10.0965568029741,5.92234786645975,6.31095685405191,1.19738426518161,7.53086424278561,3.49210653187241,9.95190299859271,5.77373886668123,10.7950884599704,2.6554671322275,7.83823209405411,5.76735201369505,2.92245766870677,10.2284400634188,2.60929867808241,10.5098499841336,10.0774262113776,9.17707560928073,6.40626206008252,1.69612719015684,8.50727720456664,4.87402855199762,0.557934029418975,7.61802210886497,1.98254386184737,3.57877693812829,4.2238780146651,10.1093952661473,5.8687118231738,8.57697638930287,4.07500190477353,4.86678093282506,1.84977821473498,7.09243503946345,0.423308144779876,4.14814968409482,8.93622057375033,2.60982231516857,4.45514681025408,1.16492876323406,10.2261653237138,8.10432797050104,5.43751716398168,4.86210731993429,6.97289654268418,0.731466472712345,5.16962564091664,2.6382255293522,9.47285143264104,5.20847317821346,6.43079684870318,5.09004349368624,6.24179119707085,5.33378385702614,1.59658589621074,3.55550250368658,2.17351429426111,5.37532622809522,9.20468488692772,3.36634467225987,0.811484350450337,6.49889118117746,10.4843846759107,0.817217982453294,3.18590629331768,5.57156826300081,2.66390379348304,4.36020066653378,6.8147494507907,9.16412917772774,9.03397296708543,8.06558036246803,5.49639457682613,9.07737713684328,9.08351857713889,3.96964909197763,6.68790020333137,1.17881814908236,2.44601054052822,7.87068865332287,5.2069336018851,4.08297741017304,1.75173617743887,5.19328963865526,7.27316028255504,6.31429169725627,8.6129292640835,9.86599299491383,3.82639516598079,4.93558688714635,5.54671967335977,1.765632927306,6.19650866144337,2.24516203262843,3.68204971468542,4.56047401403543,1.37658251059242,10.1558621603716,1.73768851110246,5.37423327317927,9.44664463448804,1.95082288044505,7.05634810330346,8.1627013886068,2.22206115771085,0.634123801272362,8.73458211536519,6.48341177782975,7.6700019503152,6.32476966353599,10.6489921716275,7.42889735967852,1.37336888206657,9.88987146256492,3.99285905216355,1.82182135639247,1.23893824941013,10.5137744328287,5.00007253766991,4.94869330182206,7.53432474092115,5.08469884419814,4.95745042819996,10.3771241429308,3.9912900594715,6.91981738501694,2.18605813463219,7.62904922693037,9.06853399763349,1.08296893639956,7.67089236865286,2.68623466058169,10.8164572367491,0.948701448901556,5.03337502339855,10.2693980659638,2.25012063825969,6.33208357376978,5.51085899649188,6.68339456800372,5.82133453567978,0.385393777834252,8.50103707351256,9.48605408588424,6.85292889511213,9.03133652424905,7.47704356292263,3.94386688522995,3.33601029812358,6.6332800173806,0.981864862143993,5.80950800832361,1.9404755752394,5.66019234568346,7.55702435995918,6.24445686515886,5.50582957019564,3.67575319564901,9.41936557364184,2.52861157310661,10.5205529265245,9.95567629999481,5.6094604956964,1.87887915418949,6.77829340280499,6.6624745322438,4.65739182105288,7.15989125377033,7.68375039226841,4.84548743681982,7.52974320184439,10.8135880715586,6.98213702369947,4.65900902362075,7.76178789746016,4.20375792182051,4.30189745356329,5.24567500249948,0.880522706951015,10.3603822161583,4.65631897013169,5.57032875244506,4.6774686257774,4.74522743747104,8.67028384151869,2.02464444639161,1.89451129081193,7.11659370467998,5.2552680207137,7.46928285257425,7.31829405110329,9.98803483367432,9.5070460641617,8.60040579327848,2.27779884034302,8.71538060630672,6.94936532810796,2.83290316818282,9.46258039603476,1.46234519418329,10.0339330355264,5.91475202376023,6.06461073501036,7.97710238370579,8.29941592193674,2.7789592781337,6.61853272209875,5.87749653918203,6.30189642292447,1.90767801002599,8.27935073037166,9.81271979646757,5.70559240777511,5.28040529130958,2.86492026405409,5.18400057546794,6.07619905733038,9.3066126292944,7.19223313588183,4.96308721355163,5.46039133285172,1.69539569513872,8.67676001084503,6.24483741640579,1.93362652644981,2.5633607571898,2.11096341992728,3.65772503514774,0.993250039801933,6.6844760884624,9.19164604401216,4.81714307521936,9.23824049684219,4.22957871334627,1.75385763783474,2.86566338464152,9.88406389998272,9.65226726036053,7.55119432061445,6.42948439291213,6.20892920972314,3.50892429538071,1.61824233881664,8.3517444113316,6.27488123073243,4.08797657623421,1.21489213926252,10.7320048124017,8.80195973049849,0.887052017836832,1.89468055403791,9.47727764477953,9.39162675925531,2.6396019232925,6.28402709887363,6.31174173386302,5.26776289668866,3.31022505840287,6.46750261064153,10.553633861267,6.9555536653148,0.598144185696729,9.97979801605456,3.15167993223295,7.29277274456807,8.75973926906008,10.0622535453504,2.86476274553221,9.5944211352896,6.74356344906148,0.610484707667492,7.6403609902598,9.83068739678711,10.7597812808258,2.31256872657686,0.990562408720143,3.10177239567041,5.68504708813969,3.50665181427263,7.51196588459425,4.61739233726636,0.795790008096956,7.72784567779861,8.90143131570425,9.0295913063921,1.22328157598618,6.47326827500947,3.06005643281154,7.15123161439318,1.39414190302137,2.7568162096478,10.0295791704673,4.26698278133757,8.95657032122836,8.49994739232119,6.18536534228828,3.81239170609508,7.35267354506068,4.33934751006309,6.32350830167532,2.30194965259172,4.56987262413837,10.628381521455,1.92535632378887,6.3021723912051,7.35170201827306,2.52622064223979,6.87477290550713,6.84953918785788,6.69551698396914,7.43355309986975,3.15375071567018,9.34923449304886,0.295938600972295,4.29305964563508,0.449205311629921,3.08569547429681,4.73154287906364,2.43667879730463,3.29166684987489,2.74252815413754,10.3833388759382,1.10359833540861,1.65675031964201,3.76213625873439,10.7230504434975,6.72281810212415,2.34463035155553,3.7009112900123,3.34716072317213,4.969904840542,7.84040917798411,8.79149812539574,8.27400605109986,5.09770767259412,1.0055679931771,6.57837934099138,10.824815214444,2.08492488476448,0.708877572081983,9.38187175248284,9.93710095591378,9.75928935251664,6.45537788892165,3.46754601510242,3.33042805664707,6.38880748888943,8.04356862767134,1.18283971248195,9.60273356130347,10.6141879398283,4.54505106071942,0.865933833629824,1.38251693930943,9.07380709427409,7.754135207613,10.0115361900954,7.59687878970057,6.60985361907631,8.45085524400231,1.23320204608142,3.5971083636675,1.95497513222042,10.3980175073911,4.20380493538454,5.86730045324657,3.86871647004969,1.26710666134488,7.27372709359042,4.20698339929339,2.93682361850981,7.68975798959844,1.55549045431893,2.51656718546059,4.41174472287297,9.02078395229299,0.463706213841215,5.33918543308508,3.39015296704136,3.39987334282137,0.690451960568316,4.19371931965929,8.75244419949595,1.05357455804478,0.476860612533055,4.04622811936308,0.536186664635316,5.88581441809423,4.40628328406718,9.88093101257458,6.05612704033498,4.96273211495485,1.10217938801274,10.6095465454506,9.38894685704261,2.74532691315282,4.76752219183836,6.60314898150042,3.36759335867595,1.84986510122195,5.12719423645176,1.70782128927298,7.29661376664881,5.38536258903332,9.57570505579934,8.6041401177505,4.22709048659075,1.2142590470938,5.10552114475984,6.39073442452122,3.54832770813257,0.493462640321814,3.99830172475893,5.14882051561959,5.01759639318567,10.5478468742548,2.6196825551847,2.1788726095017,9.40769558690954,4.97818027520552,3.25638926083222,1.4631441393448,7.83186047791038,9.73895557158161,7.14003230685368,9.25265326661524,0.419369044988416,10.1754712468991,1.85826848664321,1.77843453315552,6.47626679327339,0.538523272522725,0.87392609980423,4.62913925280329,2.42049259210471,2.97942712806165,8.53356704462785,0.830222857063636,1.94633488451131,0.641784001574852,6.14687527139206,9.99210986873601,0.414717519190162,9.24498081032187,9.67512761455961,7.15284686861094,1.28369604595471,2.68932512359694,7.61362900626846,2.96461295597255,9.00477185761556,5.44658088620752,8.6658168803202,3.32613172127865,10.0199105984624,2.09935106712859,1.16545441568363,0.316828398834914,3.34295980980154,6.4664249546174,7.16040172894485,5.96108847532421,6.47776233192533,5.00843988481909,7.35245141577441,5.77589413405396,10.3262315106252,8.57980655522551,9.03689759944566,7.84235922079999,2.79075564701576,7.47270639410708,7.186590979537,2.86525778282434,9.90785966327414,8.87082754307426,0.71606902168598,0.710000062496401,10.4687911191024,8.19697598190512,3.86889287391678,1.31168495899998,7.80676878877915,10.4795259772055,4.31068388213404,7.38563665302005,1.12772146867588,10.609615948908,8.46024549233262,9.11578437679913,2.30226822644938,1.66335595373064,8.1469240142731,8.52143364344258,5.07669484324753,6.49994143371936,10.2350199048268,10.8066019035969,1.34362290221732,10.7002983530331,7.66853416758589,8.02840707840864,4.13884886627551,10.5058506468171,2.26424725869205,4.67541972591076,7.51889029606246,9.47274079117458,1.47530261592008,4.70793903198093,3.85803619305138,0.393106290716678,4.26202515856829,5.37585077110212,8.4787743341364,6.8530932514742,9.86512561178301,10.7123206858523,8.80166462122928,5.6140888324054,8.11561548493803,6.6619020995358,3.05632559551392,5.4951428202074,5.02193238058128,1.53173387892544,8.75738151226658,8.65241829503328,6.33335350837093,0.791343873147853,10.0872086414881,2.81392519320827,1.73874310461804,2.11696159071755,10.8324802198494,5.33789171620272,7.56667996364646,1.04237854160368,10.6986943620164,9.98480634556618,0.630318134920672,3.98702692299616,6.5246683470346,7.05732746072114,8.68546958507039,5.5431232300261,5.0910423941724,8.06125226030592,1.88723235656507,0.831642122152261,3.94152836622205,6.49574677740689,3.33390363774262,10.0610746123502,3.19548454130068,2.9412130502658,3.59471368253697,2.65798319184687,0.425297149633989,10.0072917081416,7.987490480165,6.31223100800999,9.40984902506694,7.17782759610098,6.27757355274633,9.52744743671268,1.1467475319095,10.8147936485568,0.563963262122124,8.60018996076193,1.3588449099008,2.59508921926375,5.43746304452419,4.8266672012629,5.00583355578128,5.14086591341067,8.98842013945337,5.52550320792012,1.7425838214159,2.5307025970472,0.365483394474722,6.64239663048647,7.28912835941184,7.14421015771572,2.58945709257852,8.46123615018092,6.71869100019801,10.051201937641,7.25372217677999,5.90322983613703,3.84992453893181,2.04925336414948,4.81032005489804,2.57587725612801,5.98220494945068,2.68236446785275,10.0466320514353,5.82497794790194,5.78848906090949,4.31774792453274,3.46246235765982,8.72750836348161,9.52796208160464,8.18817052155267,0.923432072722353,1.04764569143299,8.36294553815853,4.54103222749196,3.51235890900251,10.5951101125311,7.92069576422684,5.30452105807606,0.414692816096358,2.41774802700616,0.829582187426277,6.12766493394971,2.05972656255588,0.741130507667549,10.476091629155,10.1750504330592,10.825834985855,3.41326426128857,3.53196238626726,3.39791329764761,3.62937746931799,0.476540857255459,7.41417303259019,8.17260787773877,2.08892354201991,2.72709868563805,2.06394115160685,9.93245465219021,9.87210766711272,2.39792031574063,10.5346175149642,5.29459338529036,3.97147656247485,1.92296132992953,0.814958894080482,4.3490569651546,5.26223608267028,10.8115997393196,1.54872660675552,8.37737595725339];

let transformed = transformations.uniformBatch(oriData, shape(oriData));

console.log('transfromed');

// transformed.shift();

// transformed.pop();

let z = andersonDarlingTest(transformed);

console.log(z);

console.log(adpValueUniform(z));

// let dn = kolmogorovSmirnovTest(transformed);

// console.log("|Uniform|" + z.toFixed(5).toString() + "|" + adpValueUniform(z).toFixed(5).toString() + "|" + dn.toFixed(5).toString() + "|" + kspValueUniform(transformed.length, dn).toFixed(5).toString() + "|");


// console.log("Log-Norm:");
// var file = ".\\lgnorm_dist1.json"
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("Uniform:");
// var file = ".\\unif_dist1.json"
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("Triangle:");
// var file = ".\\tri_dist1.json"
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("Exponent:");
// var file = ".\\exp_dist1.json"
// var dist_data = JSON.parse(fs.readFileSync(file));
// batchTest(dist_data);

// console.log("Gamma:");
// var file = ".\\gamma_dist1.json";
// var dist_data = JSON.parse(fs.readFileSync(file));
// transformed = transformations.gamma(dist_data);
// adValue = andersonDarlingTest(transformed);
// alpha = spMath.mean(dist_data)**2 / spMath.variance(dist_data);